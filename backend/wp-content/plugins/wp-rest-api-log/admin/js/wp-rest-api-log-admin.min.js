/*!  - v1.6.6
 * https://github.com/petenelson/wp-rest-api-log
 * Copyright (c) 2020; * Licensed GPLv2+ */

!function(t){"use strict";var n={entry_element:null,init:function(){if(this.entry_element=t(document.getElementById("wp-rest-api-log-entry")),this.highlightBlocks(),this.adjustPostsListsTable(),"undefined"!=typeof WP_REST_API_Log_Migrate_Data&&this.migrateLegacyDB(),t("body").hasClass("settings_page_wp-rest-api-log-settings")&&t(".wp-rest-api-log-purge-all").on("click",this.purgeLog),0<this.entry_element.length)new ClipboardJS(".wp-rest-api-log-entry-copy-property")},highlightBlocks:function(){0<this.entry_element.length&&this.entry_element.find("code").each(function(e,t){hljs.highlightBlock(t)})},adjustPostsListsTable:function(){t("body").hasClass("post-type-wp-rest-api-log")&&t(".wp-list-table").removeClass("fixed")},migrateLegacyDB:function(){t.get(ajaxurl,{action:WP_REST_API_Log_Migrate_Data.action,nonce:WP_REST_API_Log_Migrate_Data.nonce})},batchPurgeLog:function(){t.ajax({url:WP_REST_API_Log_Admin_Data.endpoints.purge_entries,method:"DELETE",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",WP_REST_API_Log_Admin_Data.nonce)}}).done(function(e){e&&e.entries_left_formatted&&(t(".wp-rest-api-log-purge-all-status").text(e.entries_left_formatted),0<e.entries_left&&n.batchPurgeLog())})},purgeLog:function(e){e.preventDefault(),t(".wp-rest-api-log-purge-all").addClass("hidden"),t(".wp-rest-api-log-purge-all-spinner").removeClass("hidden").addClass("is-active"),t(".wp-rest-api-log-purge-all-status").removeClass("hidden").addClass("is-active"),n.batchPurgeLog()}};t(document).ready(function(){n.init()})}(jQuery);